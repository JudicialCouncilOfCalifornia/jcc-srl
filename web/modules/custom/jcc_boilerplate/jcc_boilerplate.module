<?php

/**
 * @file
 * Contains jcc_boilerplate.module.
 */

use Drupal\Core\Form\FormStateInterface;
use Drupal\Component\Serialization\Yaml;

/**
 * Implements hook_form_FORM_ID_alter().
 */
function jcc_boilerplate_form_node_srl_howto_instruction_edit_form_alter(&$form, FormStateInterface $form_state, $form_id) {

  $description_field = $form["field_paragraphs"]["widget"][1]["subform"]["field_steps"]["widget"][0]["subform"]["field_description"];
  $trigger = $form_state->getUserInput()['_triggering_element_value'];


  $module_handler = \Drupal::service('module_handler');
  $module_path = $module_handler->getModule('jcc_boilerplate')->getPath();
  $boilerplate_text = Yaml::decode(file_get_contents($module_path .'/jcc_boilerplate.service.yml'));


  if ($description_field && ($trigger == 'Add Boilerplate Step')) {

    $form["field_paragraphs"]["widget"][1]["subform"]["field_steps"]["widget"][0]["subform"]["field_description"]["widget"][0]["#default_value"] = $boilerplate_text['step0']['description'];
    $form["field_paragraphs"]["widget"][1]["subform"]["field_steps"]["widget"][1]["subform"]["field_description"]["widget"][0]["#default_value"] = $boilerplate_text['step1']['description'];
  }
}
